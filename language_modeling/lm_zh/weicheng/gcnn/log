2018-06-02 17:25:44,825 - lm_zh - INFO - Parse config file ...
2018-06-02 17:25:44,826 - lm_zh - INFO - Running with config: {'batch_size': 32, 'epoch': 13, 'init_scale': 1.0, 'embed_size': 200, 'num_sampled': 0, 'lr': 1.0, 'lr_decay': 0.5, 'lr_keep_epoch': 4, 'keep_prob': 1.0, 'num_steps': 20, 'num_layers': 2, 'max_grad_norm': 5.0, 'algo': 'gcnn', 'hidden_size': 200, 'filter_w': 5, 'filter_size': 64, 'block_size': 1}
2018-06-02 17:25:44,826 - lm_zh - INFO - Build vocab and dataset ...
2018-06-02 17:25:44,829 - lm_zh - INFO - Vocab size: 6002
2018-06-02 17:25:44,889 - lm_zh - INFO - Train dataset has 112640 words
2018-06-02 17:25:44,894 - lm_zh - INFO - Valid dataset has 6400 words
2018-06-02 17:25:44,894 - lm_zh - INFO - Build graph ...
2018-06-02 17:25:45,540 - lm_zh - INFO - Start train model ...
2018-06-02 17:25:45,544 - lm_zh - INFO - Start epoch 1 ...
2018-06-02 17:25:47,174 - lm_zh - INFO - Epoch 1 perplexity: 1326.603
2018-06-02 17:25:47,174 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:25:47,264 - lm_zh - INFO - Valid data perplexity: 63.045
2018-06-02 17:25:47,264 - lm_zh - INFO - Save model to weicheng/gcnn/, with prefix gcnn ...
2018-06-02 17:25:47,310 - lm_zh - INFO - Start epoch 2 ...
2018-06-02 17:25:48,232 - lm_zh - INFO - Epoch 2 perplexity: 30.892
2018-06-02 17:25:48,233 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:25:48,270 - lm_zh - INFO - Valid data perplexity: 29.991
2018-06-02 17:25:48,271 - lm_zh - INFO - Save model to weicheng/gcnn/, with prefix gcnn ...
2018-06-02 17:25:48,346 - lm_zh - INFO - Start epoch 3 ...
2018-06-02 17:25:49,305 - lm_zh - INFO - Epoch 3 perplexity: 17.659
2018-06-02 17:25:49,305 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:25:49,336 - lm_zh - INFO - Valid data perplexity: 20.980
2018-06-02 17:25:49,336 - lm_zh - INFO - Save model to weicheng/gcnn/, with prefix gcnn ...
2018-06-02 17:25:49,405 - lm_zh - INFO - Start epoch 4 ...
2018-06-02 17:25:50,585 - lm_zh - INFO - Epoch 4 perplexity: 13.085
2018-06-02 17:25:50,586 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:25:50,627 - lm_zh - INFO - Valid data perplexity: 18.799
2018-06-02 17:25:50,627 - lm_zh - INFO - Save model to weicheng/gcnn/, with prefix gcnn ...
2018-06-02 17:25:50,704 - lm_zh - INFO - Start epoch 5 ...
2018-06-02 17:25:51,534 - lm_zh - INFO - Epoch 5 perplexity: 7.787
2018-06-02 17:25:51,534 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:25:51,570 - lm_zh - INFO - Valid data perplexity: 11.863
2018-06-02 17:25:51,570 - lm_zh - INFO - Save model to weicheng/gcnn/, with prefix gcnn ...
2018-06-02 17:25:51,646 - lm_zh - INFO - Start epoch 6 ...
2018-06-02 17:25:52,709 - lm_zh - INFO - Epoch 6 perplexity: 4.818
2018-06-02 17:25:52,709 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:25:52,740 - lm_zh - INFO - Valid data perplexity: 10.678
2018-06-02 17:25:52,741 - lm_zh - INFO - Save model to weicheng/gcnn/, with prefix gcnn ...
2018-06-02 17:25:52,810 - lm_zh - INFO - Start epoch 7 ...
2018-06-02 17:25:53,623 - lm_zh - INFO - Epoch 7 perplexity: 3.524
2018-06-02 17:25:53,623 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:25:53,655 - lm_zh - INFO - Valid data perplexity: 11.101
2018-06-02 17:25:53,655 - lm_zh - INFO - Start epoch 8 ...
2018-06-02 17:25:54,777 - lm_zh - INFO - Epoch 8 perplexity: 2.935
2018-06-02 17:25:54,777 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:25:54,815 - lm_zh - INFO - Valid data perplexity: 12.004
2018-06-02 17:25:54,815 - lm_zh - INFO - Start epoch 9 ...
2018-06-02 17:25:55,629 - lm_zh - INFO - Epoch 9 perplexity: 2.662
2018-06-02 17:25:55,629 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:25:55,658 - lm_zh - INFO - Valid data perplexity: 12.783
2018-06-02 17:25:55,659 - lm_zh - INFO - Start epoch 10 ...
2018-06-02 17:25:56,465 - lm_zh - INFO - Epoch 10 perplexity: 2.532
2018-06-02 17:25:56,466 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:25:56,499 - lm_zh - INFO - Valid data perplexity: 13.214
2018-06-02 17:25:56,499 - lm_zh - INFO - Start epoch 11 ...
2018-06-02 17:25:57,582 - lm_zh - INFO - Epoch 11 perplexity: 2.470
2018-06-02 17:25:57,582 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:25:57,613 - lm_zh - INFO - Valid data perplexity: 13.465
2018-06-02 17:25:57,614 - lm_zh - INFO - Start epoch 12 ...
2018-06-02 17:25:58,573 - lm_zh - INFO - Epoch 12 perplexity: 2.439
2018-06-02 17:25:58,573 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:25:58,608 - lm_zh - INFO - Valid data perplexity: 13.587
2018-06-02 17:25:58,608 - lm_zh - INFO - Start epoch 13 ...
2018-06-02 17:25:59,733 - lm_zh - INFO - Epoch 13 perplexity: 2.424
2018-06-02 17:25:59,733 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:25:59,773 - lm_zh - INFO - Valid data perplexity: 13.646
2018-06-02 17:25:59,774 - lm_zh - INFO - Train done
2018-06-02 17:26:07,433 - lm_zh - INFO - Parse config file ...
2018-06-02 17:26:07,434 - lm_zh - INFO - Running with config: {'batch_size': 32, 'epoch': 13, 'init_scale': 1.0, 'embed_size': 200, 'num_sampled': 0, 'lr': 1.0, 'lr_decay': 0.5, 'lr_keep_epoch': 4, 'keep_prob': 1.0, 'num_steps': 20, 'num_layers': 2, 'max_grad_norm': 5.0, 'algo': 'gcnn', 'hidden_size': 200, 'filter_w': 5, 'filter_size': 64, 'block_size': 1}
2018-06-02 17:26:07,434 - lm_zh - INFO - Build vocab and dataset ...
2018-06-02 17:26:07,437 - lm_zh - INFO - Vocab size: 6002
2018-06-02 17:26:07,449 - lm_zh - INFO - Test dataset has 7680 words
2018-06-02 17:26:07,449 - lm_zh - INFO - Build graph ...
2018-06-02 17:26:08,086 - lm_zh - INFO - Restore model ...
2018-06-02 17:26:08,086 - lm_zh - INFO - Model restore from weicheng/gcnn/, with prefix gcnn ...
2018-06-02 17:26:08,101 - lm_zh - INFO - Start test model ...
2018-06-02 17:26:08,104 - lm_zh - INFO - Start eval on test data ...
2018-06-02 17:26:08,690 - lm_zh - INFO - Test data perplexity: 8.817
2018-06-02 17:26:08,690 - lm_zh - INFO - Test done

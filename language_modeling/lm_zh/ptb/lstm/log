2018-06-02 17:06:34,719 - lm_zh - INFO - Parse config file ...
2018-06-02 17:06:34,719 - lm_zh - INFO - Running with config: {'batch_size': 20, 'epoch': 13, 'init_scale': 0.1, 'embed_size': 200, 'num_sampled': 0, 'lr': 1.0, 'lr_decay': 0.5, 'lr_keep_epoch': 4, 'keep_prob': 1.0, 'num_steps': 20, 'num_layers': 2, 'max_grad_norm': 5.0, 'algo': 'lstm', 'hidden_size': 200, 'filter_w': 5, 'filter_size': 64, 'block_size': 1}
2018-06-02 17:06:34,719 - lm_zh - INFO - Build vocab and dataset ...
2018-06-02 17:06:34,905 - lm_zh - INFO - Save vocab to file data/ptb/ptb.vocab
2018-06-02 17:06:34,905 - lm_zh - INFO - Vocab size: 10002
2018-06-02 17:06:35,331 - lm_zh - INFO - Train dataset has 971600 words
2018-06-02 17:06:35,365 - lm_zh - INFO - Valid dataset has 76800 words
2018-06-02 17:06:35,365 - lm_zh - INFO - Build graph ...
2018-06-02 17:06:37,267 - lm_zh - INFO - Start train model ...
2018-06-02 17:06:37,272 - lm_zh - INFO - Start epoch 1 ...
2018-06-02 17:07:06,539 - lm_zh - INFO - Epoch 1 perplexity: 226.209
2018-06-02 17:07:06,539 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:07:07,522 - lm_zh - INFO - Valid data perplexity: 149.305
2018-06-02 17:07:07,522 - lm_zh - INFO - Save model to ptb/lstm/, with prefix lstm ...
2018-06-02 17:07:07,616 - lm_zh - INFO - Start epoch 2 ...
2018-06-02 17:07:36,651 - lm_zh - INFO - Epoch 2 perplexity: 121.369
2018-06-02 17:07:36,651 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:07:37,599 - lm_zh - INFO - Valid data perplexity: 121.204
2018-06-02 17:07:37,599 - lm_zh - INFO - Save model to ptb/lstm/, with prefix lstm ...
2018-06-02 17:07:37,683 - lm_zh - INFO - Start epoch 3 ...
2018-06-02 17:08:06,885 - lm_zh - INFO - Epoch 3 perplexity: 96.719
2018-06-02 17:08:06,885 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:08:07,817 - lm_zh - INFO - Valid data perplexity: 113.490
2018-06-02 17:08:07,818 - lm_zh - INFO - Save model to ptb/lstm/, with prefix lstm ...
2018-06-02 17:08:07,899 - lm_zh - INFO - Start epoch 4 ...
2018-06-02 17:08:37,321 - lm_zh - INFO - Epoch 4 perplexity: 83.035
2018-06-02 17:08:37,321 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:08:38,272 - lm_zh - INFO - Valid data perplexity: 109.705
2018-06-02 17:08:38,272 - lm_zh - INFO - Save model to ptb/lstm/, with prefix lstm ...
2018-06-02 17:08:38,354 - lm_zh - INFO - Start epoch 5 ...
2018-06-02 17:09:07,553 - lm_zh - INFO - Epoch 5 perplexity: 63.374
2018-06-02 17:09:07,553 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:09:08,502 - lm_zh - INFO - Valid data perplexity: 102.808
2018-06-02 17:09:08,502 - lm_zh - INFO - Save model to ptb/lstm/, with prefix lstm ...
2018-06-02 17:09:08,583 - lm_zh - INFO - Start epoch 6 ...
2018-06-02 17:09:37,898 - lm_zh - INFO - Epoch 6 perplexity: 51.078
2018-06-02 17:09:37,898 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:09:38,846 - lm_zh - INFO - Valid data perplexity: 103.797
2018-06-02 17:09:38,846 - lm_zh - INFO - Start epoch 7 ...
2018-06-02 17:10:08,190 - lm_zh - INFO - Epoch 7 perplexity: 44.329
2018-06-02 17:10:08,191 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:10:09,131 - lm_zh - INFO - Valid data perplexity: 106.112
2018-06-02 17:10:09,131 - lm_zh - INFO - Start epoch 8 ...
2018-06-02 17:10:38,491 - lm_zh - INFO - Epoch 8 perplexity: 40.796
2018-06-02 17:10:38,491 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:10:39,429 - lm_zh - INFO - Valid data perplexity: 108.010
2018-06-02 17:10:39,429 - lm_zh - INFO - Start epoch 9 ...
2018-06-02 17:11:08,753 - lm_zh - INFO - Epoch 9 perplexity: 38.978
2018-06-02 17:11:08,753 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:11:09,699 - lm_zh - INFO - Valid data perplexity: 108.996
2018-06-02 17:11:09,700 - lm_zh - INFO - Start epoch 10 ...
2018-06-02 17:11:38,936 - lm_zh - INFO - Epoch 10 perplexity: 38.048
2018-06-02 17:11:38,936 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:11:39,875 - lm_zh - INFO - Valid data perplexity: 109.491
2018-06-02 17:11:39,875 - lm_zh - INFO - Start epoch 11 ...
2018-06-02 17:12:09,202 - lm_zh - INFO - Epoch 11 perplexity: 37.574
2018-06-02 17:12:09,202 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:12:10,156 - lm_zh - INFO - Valid data perplexity: 109.672
2018-06-02 17:12:10,156 - lm_zh - INFO - Start epoch 12 ...
2018-06-02 17:12:39,478 - lm_zh - INFO - Epoch 12 perplexity: 37.331
2018-06-02 17:12:39,478 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:12:40,425 - lm_zh - INFO - Valid data perplexity: 109.695
2018-06-02 17:12:40,425 - lm_zh - INFO - Start epoch 13 ...
2018-06-02 17:13:09,728 - lm_zh - INFO - Epoch 13 perplexity: 37.208
2018-06-02 17:13:09,728 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:13:10,672 - lm_zh - INFO - Valid data perplexity: 109.691
2018-06-02 17:13:10,672 - lm_zh - INFO - Train done
2018-06-02 17:13:17,378 - lm_zh - INFO - Parse config file ...
2018-06-02 17:13:17,379 - lm_zh - INFO - Running with config: {'batch_size': 20, 'epoch': 13, 'init_scale': 0.1, 'embed_size': 200, 'num_sampled': 0, 'lr': 1.0, 'lr_decay': 0.5, 'lr_keep_epoch': 4, 'keep_prob': 1.0, 'num_steps': 20, 'num_layers': 2, 'max_grad_norm': 5.0, 'algo': 'lstm', 'hidden_size': 200, 'filter_w': 5, 'filter_size': 64, 'block_size': 1}
2018-06-02 17:13:17,379 - lm_zh - INFO - Build vocab and dataset ...
2018-06-02 17:13:17,383 - lm_zh - INFO - Vocab size: 10002
2018-06-02 17:13:17,428 - lm_zh - INFO - Test dataset has 85600 words
2018-06-02 17:13:17,428 - lm_zh - INFO - Build graph ...
2018-06-02 17:13:19,255 - lm_zh - INFO - Restore model ...
2018-06-02 17:13:19,255 - lm_zh - INFO - Model restore from ptb/lstm/, with prefix lstm ...
2018-06-02 17:13:19,282 - lm_zh - INFO - Start test model ...
2018-06-02 17:13:19,284 - lm_zh - INFO - Start eval on test data ...
2018-06-02 17:13:20,125 - lm_zh - INFO - Test data perplexity: 96.895
2018-06-02 17:13:20,126 - lm_zh - INFO - Test done

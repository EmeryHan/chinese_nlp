2018-06-02 17:14:23,988 - lm_zh - INFO - Parse config file ...
2018-06-02 17:14:23,988 - lm_zh - INFO - Running with config: {'batch_size': 32, 'epoch': 13, 'init_scale': 1.0, 'embed_size': 200, 'num_sampled': 0, 'lr': 1.0, 'lr_decay': 0.5, 'lr_keep_epoch': 4, 'keep_prob': 1.0, 'num_steps': 20, 'num_layers': 2, 'max_grad_norm': 5.0, 'algo': 'gcnn', 'hidden_size': 200, 'filter_w': 5, 'filter_size': 64, 'block_size': 1}
2018-06-02 17:14:23,988 - lm_zh - INFO - Build vocab and dataset ...
2018-06-02 17:14:23,993 - lm_zh - INFO - Vocab size: 10002
2018-06-02 17:14:24,410 - lm_zh - INFO - Train dataset has 971520 words
2018-06-02 17:14:24,443 - lm_zh - INFO - Valid dataset has 76800 words
2018-06-02 17:14:24,444 - lm_zh - INFO - Build graph ...
2018-06-02 17:14:25,145 - lm_zh - INFO - Start train model ...
2018-06-02 17:14:25,149 - lm_zh - INFO - Start epoch 1 ...
2018-06-02 17:14:36,145 - lm_zh - INFO - Epoch 1 perplexity: 83.103
2018-06-02 17:14:36,146 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:14:36,649 - lm_zh - INFO - Valid data perplexity: 40.021
2018-06-02 17:14:36,649 - lm_zh - INFO - Save model to ptb/gcnn/, with prefix gcnn ...
2018-06-02 17:14:36,772 - lm_zh - INFO - Start epoch 2 ...
2018-06-02 17:14:47,133 - lm_zh - INFO - Epoch 2 perplexity: 43.450
2018-06-02 17:14:47,133 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:14:47,636 - lm_zh - INFO - Valid data perplexity: 40.370
2018-06-02 17:14:47,637 - lm_zh - INFO - Start epoch 3 ...
2018-06-02 17:14:58,457 - lm_zh - INFO - Epoch 3 perplexity: 40.080
2018-06-02 17:14:58,457 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:14:58,997 - lm_zh - INFO - Valid data perplexity: 37.768
2018-06-02 17:14:58,997 - lm_zh - INFO - Save model to ptb/gcnn/, with prefix gcnn ...
2018-06-02 17:14:59,090 - lm_zh - INFO - Start epoch 4 ...
2018-06-02 17:15:09,079 - lm_zh - INFO - Epoch 4 perplexity: 38.603
2018-06-02 17:15:09,079 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:15:09,581 - lm_zh - INFO - Valid data perplexity: 32.824
2018-06-02 17:15:09,582 - lm_zh - INFO - Save model to ptb/gcnn/, with prefix gcnn ...
2018-06-02 17:15:09,682 - lm_zh - INFO - Start epoch 5 ...
2018-06-02 17:15:20,193 - lm_zh - INFO - Epoch 5 perplexity: 25.353
2018-06-02 17:15:20,194 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:15:20,727 - lm_zh - INFO - Valid data perplexity: 22.971
2018-06-02 17:15:20,727 - lm_zh - INFO - Save model to ptb/gcnn/, with prefix gcnn ...
2018-06-02 17:15:20,822 - lm_zh - INFO - Start epoch 6 ...
2018-06-02 17:15:31,469 - lm_zh - INFO - Epoch 6 perplexity: 19.801
2018-06-02 17:15:31,469 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:15:31,964 - lm_zh - INFO - Valid data perplexity: 18.153
2018-06-02 17:15:31,964 - lm_zh - INFO - Save model to ptb/gcnn/, with prefix gcnn ...
2018-06-02 17:15:32,056 - lm_zh - INFO - Start epoch 7 ...
2018-06-02 17:15:42,610 - lm_zh - INFO - Epoch 7 perplexity: 15.552
2018-06-02 17:15:42,611 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:15:43,113 - lm_zh - INFO - Valid data perplexity: 14.798
2018-06-02 17:15:43,113 - lm_zh - INFO - Save model to ptb/gcnn/, with prefix gcnn ...
2018-06-02 17:15:43,212 - lm_zh - INFO - Start epoch 8 ...
2018-06-02 17:15:53,938 - lm_zh - INFO - Epoch 8 perplexity: 13.573
2018-06-02 17:15:53,939 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:15:54,475 - lm_zh - INFO - Valid data perplexity: 13.862
2018-06-02 17:15:54,476 - lm_zh - INFO - Save model to ptb/gcnn/, with prefix gcnn ...
2018-06-02 17:15:54,579 - lm_zh - INFO - Start epoch 9 ...
2018-06-02 17:16:04,970 - lm_zh - INFO - Epoch 9 perplexity: 12.691
2018-06-02 17:16:04,970 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:16:05,473 - lm_zh - INFO - Valid data perplexity: 13.343
2018-06-02 17:16:05,474 - lm_zh - INFO - Save model to ptb/gcnn/, with prefix gcnn ...
2018-06-02 17:16:05,566 - lm_zh - INFO - Start epoch 10 ...
2018-06-02 17:16:15,939 - lm_zh - INFO - Epoch 10 perplexity: 12.212
2018-06-02 17:16:15,939 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:16:16,443 - lm_zh - INFO - Valid data perplexity: 13.116
2018-06-02 17:16:16,443 - lm_zh - INFO - Save model to ptb/gcnn/, with prefix gcnn ...
2018-06-02 17:16:16,536 - lm_zh - INFO - Start epoch 11 ...
2018-06-02 17:16:26,973 - lm_zh - INFO - Epoch 11 perplexity: 11.967
2018-06-02 17:16:26,974 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:16:27,410 - lm_zh - INFO - Valid data perplexity: 12.974
2018-06-02 17:16:27,410 - lm_zh - INFO - Save model to ptb/gcnn/, with prefix gcnn ...
2018-06-02 17:16:27,504 - lm_zh - INFO - Start epoch 12 ...
2018-06-02 17:16:38,098 - lm_zh - INFO - Epoch 12 perplexity: 11.837
2018-06-02 17:16:38,098 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:16:38,636 - lm_zh - INFO - Valid data perplexity: 12.909
2018-06-02 17:16:38,636 - lm_zh - INFO - Save model to ptb/gcnn/, with prefix gcnn ...
2018-06-02 17:16:38,732 - lm_zh - INFO - Start epoch 13 ...
2018-06-02 17:16:49,288 - lm_zh - INFO - Epoch 13 perplexity: 11.771
2018-06-02 17:16:49,288 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:16:49,823 - lm_zh - INFO - Valid data perplexity: 12.875
2018-06-02 17:16:49,824 - lm_zh - INFO - Save model to ptb/gcnn/, with prefix gcnn ...
2018-06-02 17:16:49,914 - lm_zh - INFO - Train done
2018-06-02 17:16:53,812 - lm_zh - INFO - Parse config file ...
2018-06-02 17:16:53,812 - lm_zh - INFO - Running with config: {'batch_size': 32, 'epoch': 13, 'init_scale': 1.0, 'embed_size': 200, 'num_sampled': 0, 'lr': 1.0, 'lr_decay': 0.5, 'lr_keep_epoch': 4, 'keep_prob': 1.0, 'num_steps': 20, 'num_layers': 2, 'max_grad_norm': 5.0, 'algo': 'gcnn', 'hidden_size': 200, 'filter_w': 5, 'filter_size': 64, 'block_size': 1}
2018-06-02 17:16:53,812 - lm_zh - INFO - Build vocab and dataset ...
2018-06-02 17:16:53,817 - lm_zh - INFO - Vocab size: 10002
2018-06-02 17:16:53,862 - lm_zh - INFO - Test dataset has 85760 words
2018-06-02 17:16:53,862 - lm_zh - INFO - Build graph ...
2018-06-02 17:16:54,508 - lm_zh - INFO - Restore model ...
2018-06-02 17:16:54,508 - lm_zh - INFO - Model restore from ptb/gcnn/, with prefix gcnn ...
2018-06-02 17:16:54,525 - lm_zh - INFO - Start test model ...
2018-06-02 17:16:54,528 - lm_zh - INFO - Start eval on test data ...
2018-06-02 17:16:55,418 - lm_zh - INFO - Test data perplexity: 11.978
2018-06-02 17:16:55,418 - lm_zh - INFO - Test done

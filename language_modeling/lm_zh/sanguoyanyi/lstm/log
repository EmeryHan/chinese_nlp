2018-06-02 17:18:24,768 - lm_zh - INFO - Parse config file ...
2018-06-02 17:18:24,768 - lm_zh - INFO - Running with config: {'batch_size': 20, 'epoch': 13, 'init_scale': 0.1, 'embed_size': 200, 'num_sampled': 0, 'lr': 1.0, 'lr_decay': 0.5, 'lr_keep_epoch': 4, 'keep_prob': 1.0, 'num_steps': 20, 'num_layers': 2, 'max_grad_norm': 5.0, 'algo': 'lstm', 'hidden_size': 200, 'filter_w': 5, 'filter_size': 64, 'block_size': 1}
2018-06-02 17:18:24,769 - lm_zh - INFO - Build vocab and dataset ...
2018-06-02 17:18:24,819 - lm_zh - INFO - Save vocab to file data/sanguoyanyi/sanguoyanyi.vocab
2018-06-02 17:18:24,819 - lm_zh - INFO - Vocab size: 3828
2018-06-02 17:18:25,008 - lm_zh - INFO - Train dataset has 407200 words
2018-06-02 17:18:25,027 - lm_zh - INFO - Valid dataset has 38800 words
2018-06-02 17:18:25,027 - lm_zh - INFO - Build graph ...
2018-06-02 17:18:26,917 - lm_zh - INFO - Start train model ...
2018-06-02 17:18:26,921 - lm_zh - INFO - Start epoch 1 ...
2018-06-02 17:18:37,502 - lm_zh - INFO - Epoch 1 perplexity: 575.306
2018-06-02 17:18:37,502 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:18:37,934 - lm_zh - INFO - Valid data perplexity: 316.501
2018-06-02 17:18:37,934 - lm_zh - INFO - Save model to sanguoyanyi/lstm/, with prefix lstm ...
2018-06-02 17:18:38,003 - lm_zh - INFO - Start epoch 2 ...
2018-06-02 17:18:48,449 - lm_zh - INFO - Epoch 2 perplexity: 224.082
2018-06-02 17:18:48,449 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:18:48,848 - lm_zh - INFO - Valid data perplexity: 201.868
2018-06-02 17:18:48,848 - lm_zh - INFO - Save model to sanguoyanyi/lstm/, with prefix lstm ...
2018-06-02 17:18:48,904 - lm_zh - INFO - Start epoch 3 ...
2018-06-02 17:18:59,322 - lm_zh - INFO - Epoch 3 perplexity: 149.916
2018-06-02 17:18:59,322 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:18:59,723 - lm_zh - INFO - Valid data perplexity: 170.887
2018-06-02 17:18:59,723 - lm_zh - INFO - Save model to sanguoyanyi/lstm/, with prefix lstm ...
2018-06-02 17:18:59,778 - lm_zh - INFO - Start epoch 4 ...
2018-06-02 17:19:10,255 - lm_zh - INFO - Epoch 4 perplexity: 117.014
2018-06-02 17:19:10,255 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:19:10,653 - lm_zh - INFO - Valid data perplexity: 159.766
2018-06-02 17:19:10,654 - lm_zh - INFO - Save model to sanguoyanyi/lstm/, with prefix lstm ...
2018-06-02 17:19:10,707 - lm_zh - INFO - Start epoch 5 ...
2018-06-02 17:19:21,146 - lm_zh - INFO - Epoch 5 perplexity: 81.965
2018-06-02 17:19:21,146 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:19:21,547 - lm_zh - INFO - Valid data perplexity: 147.971
2018-06-02 17:19:21,547 - lm_zh - INFO - Save model to sanguoyanyi/lstm/, with prefix lstm ...
2018-06-02 17:19:21,602 - lm_zh - INFO - Start epoch 6 ...
2018-06-02 17:19:32,029 - lm_zh - INFO - Epoch 6 perplexity: 61.326
2018-06-02 17:19:32,029 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:19:32,434 - lm_zh - INFO - Valid data perplexity: 148.814
2018-06-02 17:19:32,434 - lm_zh - INFO - Start epoch 7 ...
2018-06-02 17:19:42,871 - lm_zh - INFO - Epoch 7 perplexity: 50.591
2018-06-02 17:19:42,871 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:19:43,263 - lm_zh - INFO - Valid data perplexity: 154.422
2018-06-02 17:19:43,263 - lm_zh - INFO - Start epoch 8 ...
2018-06-02 17:19:53,646 - lm_zh - INFO - Epoch 8 perplexity: 45.206
2018-06-02 17:19:53,646 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:19:54,043 - lm_zh - INFO - Valid data perplexity: 158.541
2018-06-02 17:19:54,043 - lm_zh - INFO - Start epoch 9 ...
2018-06-02 17:20:04,501 - lm_zh - INFO - Epoch 9 perplexity: 42.527
2018-06-02 17:20:04,501 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:20:04,897 - lm_zh - INFO - Valid data perplexity: 161.343
2018-06-02 17:20:04,897 - lm_zh - INFO - Start epoch 10 ...
2018-06-02 17:20:15,301 - lm_zh - INFO - Epoch 10 perplexity: 41.198
2018-06-02 17:20:15,301 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:20:15,698 - lm_zh - INFO - Valid data perplexity: 162.687
2018-06-02 17:20:15,698 - lm_zh - INFO - Start epoch 11 ...
2018-06-02 17:20:26,098 - lm_zh - INFO - Epoch 11 perplexity: 40.531
2018-06-02 17:20:26,098 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:20:26,502 - lm_zh - INFO - Valid data perplexity: 163.342
2018-06-02 17:20:26,502 - lm_zh - INFO - Start epoch 12 ...
2018-06-02 17:20:36,935 - lm_zh - INFO - Epoch 12 perplexity: 40.198
2018-06-02 17:20:36,935 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:20:37,345 - lm_zh - INFO - Valid data perplexity: 163.674
2018-06-02 17:20:37,345 - lm_zh - INFO - Start epoch 13 ...
2018-06-02 17:20:47,734 - lm_zh - INFO - Epoch 13 perplexity: 40.031
2018-06-02 17:20:47,734 - lm_zh - INFO - Start eval on valid data ...
2018-06-02 17:20:48,136 - lm_zh - INFO - Valid data perplexity: 163.843
2018-06-02 17:20:48,136 - lm_zh - INFO - Train done
2018-06-02 17:20:51,714 - lm_zh - INFO - Parse config file ...
2018-06-02 17:20:51,714 - lm_zh - INFO - Running with config: {'batch_size': 20, 'epoch': 13, 'init_scale': 0.1, 'embed_size': 200, 'num_sampled': 0, 'lr': 1.0, 'lr_decay': 0.5, 'lr_keep_epoch': 4, 'keep_prob': 1.0, 'num_steps': 20, 'num_layers': 2, 'max_grad_norm': 5.0, 'algo': 'lstm', 'hidden_size': 200, 'filter_w': 5, 'filter_size': 64, 'block_size': 1}
2018-06-02 17:20:51,714 - lm_zh - INFO - Build vocab and dataset ...
2018-06-02 17:20:51,716 - lm_zh - INFO - Vocab size: 3828
2018-06-02 17:20:51,747 - lm_zh - INFO - Test dataset has 51200 words
2018-06-02 17:20:51,747 - lm_zh - INFO - Build graph ...
2018-06-02 17:20:53,863 - lm_zh - INFO - Restore model ...
2018-06-02 17:20:53,863 - lm_zh - INFO - Model restore from sanguoyanyi/lstm/, with prefix lstm ...
2018-06-02 17:20:53,881 - lm_zh - INFO - Start test model ...
2018-06-02 17:20:53,884 - lm_zh - INFO - Start eval on test data ...
2018-06-02 17:20:54,338 - lm_zh - INFO - Test data perplexity: 141.901
2018-06-02 17:20:54,338 - lm_zh - INFO - Test done
